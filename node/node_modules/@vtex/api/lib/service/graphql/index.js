"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const http_1 = require("../http");
const setCookie_1 = require("../http/middlewares/setCookie");
const error_1 = require("./middlewares/error");
const formatters_1 = require("./middlewares/formatters");
const query_1 = require("./middlewares/query");
const response_1 = require("./middlewares/response");
const run_1 = require("./middlewares/run");
const schema_1 = require("./middlewares/schema");
const timings_1 = require("./middlewares/timings");
const upload_1 = require("./middlewares/upload");
exports.GRAPHQL_ROUTE_LEGACY = '__graphql';
exports.GRAPHQL_ROUTE = 'graphql';
exports.createGraphQLRoute = (graphql, Clients, options) => {
    const injectGraphql = async (ctx, next) => {
        ctx.graphql = graphql;
        await next();
        delete ctx.graphql;
    };
    return http_1.createHttpRoute(Clients, options)([
        setCookie_1.removeSetCookie,
        injectGraphql,
        timings_1.timings,
        error_1.error,
        upload_1.upload,
        query_1.parseQuery,
        formatters_1.createFormatters,
        schema_1.injectSchema,
        run_1.run,
        response_1.response,
    ]);
};
